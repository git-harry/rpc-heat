---
bootstrap_host_aio_config: true

mgmt_ip: '%%NODE1_MGMT_IP%%'
storage_ip: '%%NODE1_STORAGE_IP%%'
tunnel_ip: '%%NODE1_TUNNEL_IP%%'

openstack_user_config_overrides:
  cidr_networks:
    container: 172.29.236.0/22
    snet: 172.29.248.0/22
    tunnel: 172.29.240.0/22
    storage: 172.29.244.0/22

  used_ips:
    - 172.29.236.1,172.29.236.50
    - 172.29.244.1,172.29.244.50

  global_overrides:
    internal_lb_vip_address: %%NODE3_MGMT_IP%%
    external_lb_vip_address: %%EXTERNAL_VIP_IP%%
    tunnel_bridge: "br-vxlan"
    management_bridge: "br-mgmt"
    provider_networks:
      - network:
          group_binds:
            - all_containers
            - hosts
          type: "raw"
          container_mtu: 1450
          container_bridge: "br-mgmt"
          container_interface: "eth1"
          container_type: "veth"
          ip_from_q: "container"
          is_container_address: true
          is_ssh_address: true
      - network:
          group_binds:
            - glance_api
            - cinder_api
            - cinder_volume
            - nova_compute
          type: "raw"
          container_mtu: 1450
          container_bridge: "br-storage"
          container_interface: "eth2"
          container_type: "veth"
          ip_from_q: "storage"
      - network:
          group_binds:
            - glance_api
            - nova_compute
            - neutron_linuxbridge_agent
          type: "raw"
          container_mtu: 1450
          container_bridge: "br-snet"
          container_interface: "eth3"
          container_type: "veth"
          ip_from_q: "snet"
      - network:
          group_binds:
            - neutron_linuxbridge_agent
          container_bridge: "br-vxlan"
          container_interface: "eth4"
          container_type: "veth"
          ip_from_q: "tunnel"
          type: "vxlan"
          range: "10:1000"
          net_name: "vxlan"
      - network:
          group_binds:
            - neutron_linuxbridge_agent
          container_bridge: "br-vlan"
          container_interface: "eth5"
          container_type: "veth"
          type: "flat"
          net_name: "flat"

  shared-infra_hosts:
    %%NODE1_NAME%%:
      ip: %%NODE1_MGMT_IP%%
    %%NODE2_NAME%%:
      ip: %%NODE2_MGMT_IP%%
      affinity:
        utility_container: 0
    %%NODE3_NAME%%:
      ip: %%NODE3_MGMT_IP%%
      affinity:
        utility_container: 0

  os-infra_hosts:
    %%NODE1_NAME%%:
      ip: %%NODE1_MGMT_IP%%
    %%NODE2_NAME%%:
      ip: %%NODE2_MGMT_IP%%
    %%NODE3_NAME%%:
      ip: %%NODE3_MGMT_IP%%

  storage-infra_hosts:
    %%NODE1_NAME%%:
      ip: %%NODE1_MGMT_IP%%
    %%NODE2_NAME%%:
      ip: %%NODE2_MGMT_IP%%
    %%NODE3_NAME%%:
      ip: %%NODE3_MGMT_IP%%

  repo-infra_hosts:
    %%NODE1_NAME%%:
      ip: %%NODE1_MGMT_IP%%
    %%NODE2_NAME%%:
      ip: %%NODE2_MGMT_IP%%
    %%NODE3_NAME%%:
      ip: %%NODE3_MGMT_IP%%

  identity_hosts:
    %%NODE1_NAME%%:
      ip: %%NODE1_MGMT_IP%%
    %%NODE2_NAME%%:
      ip: %%NODE2_MGMT_IP%%
    %%NODE3_NAME%%:
      ip: %%NODE3_MGMT_IP%%

  compute_hosts:
    %%NODE4_NAME%%:
      ip: %%NODE4_MGMT_IP%%
    %%NODE5_NAME%%:
      ip: %%NODE5_MGMT_IP%%

  log_hosts:
    %%NODE1_NAME%%:
      ip: %%NODE1_MGMT_IP%%

  network_hosts:
    %%NODE1_NAME%%:
      ip: %%NODE1_MGMT_IP%%
    %%NODE2_NAME%%:
      ip: %%NODE2_MGMT_IP%%
    %%NODE3_NAME%%:
      ip: %%NODE3_MGMT_IP%%

  haproxy_hosts:
    %%NODE3_NAME%%:
      ip: %%NODE3_MGMT_IP%%

user_variables_overrides_defaults:
  nova_virt_type: qemu
  keystone_wsgi_processes: 4
  glance_default_store: %%GLANCE_DEFAULT_STORE%%
  glance_swift_store_auth_address: '{{ rackspace_cloud_auth_url }}'
  glance_swift_store_user: '{ rackspace_cloud_tenant_id }}:{{ rackspace_cloud_username }}'
  glance_swift_store_key: '{{ rackspace_cloud_password }}'
  glance_swift_store_region: %%GLANCE_SWIFT_STORE_REGION%%
