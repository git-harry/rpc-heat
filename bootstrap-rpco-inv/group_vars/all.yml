---
bootstrap_host_data_disk_min_size: 30
bootstrap_host_aio_config: false

id: '{{ mgmt_ip.split(".")[-1] }}'

network_interfaces:
  eth1:
    - address_family: 'inet'
      method: 'manual'
  br-snet:
    - address_family: '{{ network_interface_files.eth1.address_family }}'
      method: '{{ network_interface_files.eth1.method }}'
      options: '{{ network_interface_files.eth1.options | combine({"bridge_ports": eth1}) }}'
  eth2:
    - address_family: 'inet'
      method: 'static'
      options:
        address: '{{172.29.232.ID | replace("ID", id)}}'
        netmask: '255.255.252.0'
  vxlan2:
    - address_family: 'inet'
      method: 'manual'
      options:
        pre-up:
          - 'ip link add vxlan2 type vxlan id 2 group 239.0.0.16 ttl 4 dev eth2'
        up:
          - 'ip link set vxlan2 up'
        down:
          - 'ip link set vxlan2 down'
  br-mgmt:
    - address_family: 'inet'
      method: 'static'
      options:
        address: '{{ mgmt_ip }}'
        netmask: '255.255.252.0'
        bridge_ports: 'vxlan2'
  eth4:
    - address_family: 'inet'
      method: 'static'
      options:
        address: '{{ storage_ip }}'
        netmask: '255.255.252.0'
  vxlan4:
    - address_family: 'inet'
      method: 'manual'
      options:
        pre-up:
          - 'ip link add vxlan4 type vxlan id 4 group 239.0.0.16 ttl 4 dev eth4'
        up:
          - 'ip link set vxlan4 up'
        down:
          - 'ip link set vxlan4 down'
  vxlan5:
    # We don't have a dedicated network for this traffic, so we piggy-back on eth4
    - address_family: 'inet'
      method: 'manual'
      options:
        pre-up:
          - 'ip link add vxlan5 type vxlan id 5 group 239.0.0.16 ttl 4 dev eth4'
        up:
          - 'ip link set vxlan5 up'
        down:
          - 'ip link set vxlan5 down'
  br-storage:
    - address_family: 'inet'
      method: 'static'
      options:
        address: '{{ 172.29.244.ID | replace("ID", id) }}'
        netmask: '255.255.252.0'
        bridge_ports: 'vxlan4'
  br-vlan:
    - address_family: 'inet'
      method: 'manual'
      options:
        bridge_ports: 'vxlan5'
  eth3:
    - address_family: 'inet'
      method: 'manual'
  vxlan3:
    - address_family: 'inet'
      method: 'manual'
      options:
        pre-up:
          - 'ip link add vxlan3 type vxlan id 3 group 239.0.0.16 ttl 4 dev eth3'
        up:
          - 'ip link set vxlan3 up'
        down:
          - 'ip link set vxlan3 down'
  br-vxlan:
    - address_family: 'inet'
      method: 'manual'
      options:
        bridge_ports: 'vxlan3'
